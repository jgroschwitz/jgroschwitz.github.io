<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <title>Jonas Groschwitz Computational Linguistics</title>
    <link rel="stylesheet" href="https://stackedit.io/style.css">
    <link rel="stylesheet" href="../portfolio.css">
    <link rel="stylesheet" href="../navbar.css">
</head>

<script src="../navbar.js"></script>
<body class="stackedit" onload="fetch_header('../header.html')">
	<div id="header"></div>
	
  <div class="body-container"><h1 id="heading-top">Linear Regression for Animals in a Zoo-Building Game</h1>
  
  
<p> In this analysis, I examine the different animals available in the zoo-themed board game Ark Nova using a linear regression model. The results are not only interesting for fans of the game, but also from a pure data analysis standpoint: for example, they reveal strengths and shortcomings of the linear regression approach. In most of the text, I will assume that the reader has no prior knowledge about Ark Nova, and explain things as we go. An exception are green boxes like this:</p>

<div style="background-color: #cfc ; padding: 10px; border: 1px solid green;">
<b>Game analysis:</b> In boxes like this, I will look at some of the results purely in terms of what they mean for the game, its balance and its strategy. Therefore, inside these boxes I will assume that the reader is already familiar with Ark Nova, and is here for the insights into the game. Feel free to skip the green boxes if that's not you!
</div> 


<h2 id="game-intro">A Brief Introduction to Ark Nova</h2>

<img align="right" width="200" src="/portfolio/514.jpg" alt="The emu card in Ark Nova." style="margin:20px; margin-top:0px; margin-right: 0px;">  
<img align="right" width="200" src="/portfolio/401.jpg" alt="The cheetah card in Ark Nova." style="margin:20px; margin-top:0px; margin-right: 0px;">  <!--clear: both-->
<!--src="https://github.com/PixelT/ArkNovaCardsManager/blob/master/dist/images/animal/401.jpg"-->  
<p>Ark Nova is a 2-4 player board game where players build a zoo, trying to both attract visitors and contribute to wildlife conservation efforts. Each player starts with an empty map of their zoo, and the core game mechanic is to build enclosures and place animals inside them. The animals come in the form of cards, like the ones seen on the right. You can find a list of all Ark Nova cards for example <a href="https://ssimeonoff.github.io/ark-nova">here</a> or <a href="https://arknova.cards/">here</a>.
</p>
<p> Each animal has a <i>cost</i>, shown in the gray square on the top right (17 for the cheetah, and 22 for the emu). Each card has a range of different features that are either requirements to playing the card or benefits when you add the animal to your zoo. For example, there is the <i>minimum enclosure size</i> that the animal requires (the brown hexagon in the top left; here both animals require an enclosure of size 5). Also, on the bottom right, each animal has an <i>attraction</i> value shown on a ticket-like shape, that represents how many visitors the animal will attract to your zoo (here 6 and 7, respectively). Many animals also have special abilities printed in text on the card. For example, the cheetah allows you to draw three more cards, and the emu allows you to build a special kind of enclosure for free.
<!--Then, each animal comes with some tags on the top right, for example the cheetah has two predator tags and one Africa tag. These tags are relevent for the wildlife conservation aspect of the game (which I won't go into detail here), but some animals also require you to have certain tags before you can add that animal to your zoo. For example, the emu card shows two requires you to allready have two-->
</p>
<p> This is a very brief introduction -- I skipped over some features of the animal cards, and the game has several more mechanics going beyond adding animals to your zoo, giving it incredible complexity. But for the analysis that follows, you will only need to know these basic concepts.
</p>
<h2 id="linear-regression">Modeling Animal Cost with Linear Regression</h2>
<p>While playing the game, I was asking myself: what makes up the cost of an animal? How do each of its properties contribute to its total price? Or in other words, if I add the cheetah to my zoo, how much am I paying for the three cards that I draw, and how much for the 6 attraction value? And, following that line of thought: offer some animals more value than others? Are some overpriced, some underpriced?</p>
<p>To answer these questions, I decided to build a <i>linear regression</i> model that predicts the price of an animal based on all its other features. The features of a card are its minimum enclosure size, attraction value, special abilities and so on. Each feature has a value associated with it, for example the cheetah's feature for its "Sprint" ability has value 3, because it allows you to draw 3 cards. For each feature \(x_i\), the linear regression model then has a parameter \(\beta_i\) that weights the impact of that feature. The model computes the price of an animal like this:
\[\text{cost}=x_1\beta_1 + x_2\beta_2 + \cdots + x_n\beta_n + \epsilon,\]
where \(\epsilon\) is another parameter of the model, that just offsets all costs by a fixed amount. Note that the feature values \(x_i\) are different for each animal, but the parameters \(\beta_i\) and \(\epsilon\) are the same for all animals. Note also that technically, every animal has every feature, but most of them have value 0 so they get ignored in the above calculation. For example, the Emu also has a feature for the "Sprint" ability, but it has value 0, because the Emu does not allow you to draw any cards. This choice of including features with value zero allows us to compute the cost for all animals in the same way, using the same model parameters.
</p>
<p>
The model is then <i>fit</i> to the data, by choosing the parameters of the model such that the average error across all animals is minimized (technically, one minimizes the mean <i>squared</i> errors). Thankfully, the computer can do this fitting for us; I used the sklearn library. With the model fitted, we can have a look at how well it matches the data, i.e. how the predicted costs differ from the actual costs. I plotted all animal's predicted and actual costs in Tableau (you'll have to scroll left and right to see all the animals).
</p>
<div class='tableauPlaceholder' id='viz1738246095158' style='position: relative'><noscript><a href='#'><img alt='Final Model Predicted and Actual costs ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;FinalModelPredictedandActualcosts&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='ArcheNova&#47;FinalModelPredictedandActualcosts' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;FinalModelPredictedandActualcosts&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1738246095158');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
<p>
Overall, the predictions are pretty close! This means that the linear regression model, while being a relatively simple model, seems to be able to model the data accurately. We'll dive deeper into the appropriateness of the linear model below.
</p>
<p>But first: the nice thing about linear regression is that the resulting model is very interpretable: namely, its parameters answer my original question about how each of the features contribute to the total price. 
You simply multiply an animal's feature value with the corresponding model parameter, and that is how much the model thinks that specific feature contributes to the cost of the animal. For example, the parameter for the "Sprint" ability is \(\beta_{\text{Sprint}}=2.2\). The cheetah's value for this ability is \(x_{\text{Sprint}}=3\), meaning the total contribution of this feature to the cheetah's total cost of \(17\) is \(6.6\)! Again in Tableau, I plotted how much each feature contributes to each animal's cost. This table is the linear model's answer to my original question!
</p>

<div class='tableauPlaceholder' id='viz1738247433657' style='position: relative'><noscript><a href='#'><img alt='Final Model Tiere by Cost ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;FinalModelTierebyCost&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='ArcheNova&#47;FinalModelTierebyCost' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;FinalModelTierebyCost&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1738247433657');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
<p>Note that some features have a negative contribution to the cost. Those features are requirements on when the card can be played, and it makes sense that the model worked out that they tend to decrease the cost: if an animal has more requirements, it is more difficult to play, and to balance that out, the monetary cost can be reduced. In a way, this plot is the main technical result of my analysis. But there's much more to say! Below, I will</p>
<ul style="margin:0px; margin-left: 20px">
	  <li>compare my model to a similar (but manual!) analysis done by an Ark Nova expert,</li>
	  <li>analyze the model parameters in depth (for Ark Nova players),</li>
	  <li>discuss why this analysis has limited use for judging the balance between animals,</li>
	  <li>use this analysis to judge the balance between animals anyway, and learn more about linear regression than about the animals as a result,</li>
	  <li>and examine whether the model overfits the data.</li>
</ul>
<p>Let's dive right in!</p>

<h2 id="previous-manual-analysis">Building on Previous Work: StrategyAdvisor's Manual Analysis</h2>

While researching this topic, I found out that a YouTuber called StrategyAdvisor had made a <a href="https://www.youtube.com/watch?v=-OTo1C7-OpM">video</a> where he explores the balance of Ark Nova with a similar approach. Except that instead of fitting a linear model automatically, he chose the weights of his model manually (he shared the parameters in a <a href="https://docs.google.com/spreadsheets/d/18_m21aq99m426WB3wDSq5bOPFIXVjexpSrZwABWpQBs/edit">spreadsheet</a>). To compare my code to his work, I built a version of my model that has the same underlying assumptions (as in, how exactly the text on a card is translated into features). Here you can see the parameters of my fitted model (blue), using StrategyAdvisor's assumptions, compared to his manually chosen parameters (orange):

<div class='tableauPlaceholder' id='viz1738579677134' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;CoefficientsLRvsSA&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='ArcheNova&#47;CoefficientsLRvsSA' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;CoefficientsLRvsSA&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1738579677134');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

As you can see, they're quite close! I'm actually impressed by how closely StrategyAdvisor's values match the optimal solution that linear regression provides, given that he restricted himself to integer values, and did the whole thing by hand. I also reproduced StrategyAdvisor's results, by implementing a version of my model where I manually fix the parameters to StrategyAdvisor's ones. And it's a good thing I did, because I found a few typos in both his spreadsheet and my code! You can find the spreadsheet with my fixes <a href="https://docs.google.com/spreadsheets/d/19wb7HeT6teyjIsQwn_wMSO9kecQFXvGQB3ViY5HmKZA/edit?usp=sharing">here</a>.

In my final model (the one I use everywhere else in this post), I made a couple of adjustments compared to StrategyAdvisor's assumptions, improving model fit and hopefully consistency. For those interested in the details:

<div style="background-color: #cfc ; padding: 10px; border: 1px solid green;">
<b>Model adjustments:</b>
<ul style="margin:0px; margin-left: 20px">
	  <li>StrategyAdvisor combines multiple animal effects that combine draw and discard effects into "draw" and "discard" features (Scavenging, Hunting, Sunbathing, Pouch, Digging, Perception). Since many of these effects are conditional, or are different from drawing and discarding in possibly meaningful ways, I treat them each as a separate feature.</li>
	  <li>StrategyAdvisor uses some abilities of peaceful mode, and some of non-peaceful mode. For more consistency, I use all abilities from non-peaceful mode (which I consider the standard mode).</li>
	  <li>StrategyAdvisor fuses the Dominance and Assertion abilities; I keep them separate.</li>
</ul>
</div>

Here are the average errors that each model produces, both <a href="https://en.wikipedia.org/wiki/Mean_absolute_error">mean absolute error (MAE)</a> and <a href="https://en.wikipedia.org/wiki/Mean_squared_error">mean square error (MSE)</a>.

<style type="text/css">
  .table-container {
    margin-top: 20px; /* Buffer space above the table */
    margin-bottom: 20px; /* Buffer space below the table */
  }

  .tg {
    border-collapse: collapse;
    border-spacing: 0;
    margin-left: auto; /* Center the table horizontally */
    margin-right: auto; /* Center the table horizontally */
  }
.tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
  overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>

  <div class="table-container">
<table class="tg"><thead>
  <tr>
    <th class="tg-0lax"></th>
    <th class="tg-0lax">MAE</th>
    <th class="tg-0lax">MSE</th>
  </tr></thead>
<tbody>
  <tr>
    <td class="tg-0lax">StrategyAdvisor's Model</td>
    <td class="tg-0lax">0.83</td>
    <td class="tg-0lax">1.36</td>
  </tr>
  <tr>
    <td class="tg-0lax">Linear Regression (StrategyAdvisor-like)</td>
    <td class="tg-0lax">0.58</td>
    <td class="tg-0lax">0.52</td>
  </tr>
  <tr>
    <td class="tg-0lax">Linear Regression (final model)</td>
    <td class="tg-0lax">0.46</td>
    <td class="tg-0lax">0.36</td>
  </tr>
</tbody>
</table>
</div>

Linear regression minimizes MSE, so it is not surprising that the models perform particularly well in that measure (StrategyAdvisor aimed to minimize MAE). But it's nice to see that the mathematically optimized models also do well in terms of MAE. As we will see when we talk about overfitting below, a lower error rate is not necessarily a better model. But in principle, it is a desirable quality and I'm happy that the linear regression models do so well here.

<h2 id="feature-worth">Detailed Strategy Results: What Each Feature is Worth</h2>

This section is pretty much exclusively for Ark Nova nerds :)

<div style="background-color: #cfc ; padding: 10px; border: 1px solid green;">
<b>Game analysis:</b>
Here are all the coefficients of the final model:
<div class='tableauPlaceholder' id='viz1738578284337' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;FinalModelCoefficients&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='ArcheNova&#47;FinalModelCoefficients' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;FinalModelCoefficients&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1738578284337');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
Some observations:
<ul style="margin:0px; margin-left: 20px">
	  <li>Each attraction point ("ticket") costs ~2.7. We can compare this to some abilities that give conditional tickets: The Pack ability costs 7.8, so on average you'll want ~2.9 tickets to get good value. The Icon ability costs a whopping 15.7, so you'll want on average 5.8 tickets for good value.</li>
	  <li>Both the Scavenging and the Hunter ability let you draw a specified number of cards (let's call it X)but you only get to keep one. I modeled these with two features: one that models the number of cards you get to keep ("Hunter Keep", "Scavenging Keep"), i.e. that is always 1, and one that models the number of cards you get to look at ("Hunter Draw", "Scavenging Draw"), i.e. that is X. Interestingly, the Hunter Keep feature is about 0 and Hunter Draw is non-zero, while Scavenging Keep's cost is non-zero, but Scavenging Draw has near zero cost. This might just be an artifact of the model, but it could indicate that the number of cards you draw when hunting is more important than the number of cards you draw when scavenging.</li>
	  <li>The most expensive ability is the Emu's ability to build the special bird cage for free. While that is a useful thing to get, 16 seems like a steep cost given that building it the normal way costs 10. Seems only worth it in specific conditions, like when you want to skip the building upgrade but really want to play some birds, or if you are short on actions.</li>
	  <li>We already saw that tickets cost 2.7. Conservation points cost 7.2. Using the board game arena convention of looking at tickets giving 1 point for the final score, and conservation points (usually) 3 points, and given that \(2.7*3=8.1\), conservation points on animals seem to be a bit better value for final points.</li>
	  <li>The Inventive ability that gives you an X-marker is priced at 3.4. That's surprisingly low, given that the game usually prices X-markers at 5 (for example looking at the bonus fields you can pick up by building enclusures, or looking at the Trade ability in the Marine World expansion) or 4 (comparing the 3 X-markers and the 12 money reward for conservation projects). So getting X-markers from animals might be particularly good value.</li>
	  <li>An extra animal symbol on the card costs 1.9, while an extra continent symbol costs 4.5. The discrepancy may be due to the fact that getting a partner zoo will give you extra reduction for the extra continent symbol.</li>
</ul>
</div>

Since the coefficients of my model are close to the one in StrategyAdvisor's model, much of his <a href="https://www.youtube.com/watch?v=-OTo1C7-OpM">analysis</a> applies here too. I can only recommend the video! 

<h2 id="utility">Predicting Cost vs Analyzing Utility</h2>

It is important to keep in mind what our analysis here actually does, namely model the <i>cost</i> of an animal, and not its <i>utility</i> (which one might also call its benefit, or value). For example, if an animal costs 12, but a player values the benefit of adding it to their zoo at 15 money, then it's cost is 12 but it's utility is 15. This distinction is incredibly important when we talk about whether an animal is "good value" or "efficient" or "a strong card", because these terms evaluate whether an animal has a high utility compared to its cost. Our analysis is of only limited use to that. A YouTube channel named No Wonders actually made an <a href="https://www.youtube.com/watch?v=gCFPgfk0kSo">analysis</a> that is based on StrategyAdviser's analysis, using the same linear model, but instead of using the model's coefficients to try to predict the <i>cost</i> of an animal, the coefficients were chosen to reflect the <i>utility</i> of each effect. The results were quite different, and I definitely recommend the video.

While our analysis here as limited value in comparing cards in terms of their strength or efficiency, it still has some! When our model predicts a higher cost for an animal than it's actual cost, we can still say that that animal is cheaper than it should be under our model. That is, given the features of the animal, we pay less for it than we would pay for those features on average. That's still a valid way to look at "good value", and the next section does just that.

<h2 id="overpriced">Over- and Underpriced Animals?</h2>

<div class='tableauPlaceholder' id='viz1738587873549' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;OverUndercostedanimals&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='ArcheNova&#47;OverUndercostedanimals' /><param name='tabs' value='yes' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ar&#47;ArcheNova&#47;OverUndercostedanimals&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1738587873549');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

<style type="text/css">
.row {
  display: flex;
  flex-wrap: wrap;
  padding: 0 4px;
}

/* Create two equal columns that sits next to each other */
.column {
  flex: 50%;
  padding: 0 4px;
}

.column img {
  margin-top: 8px;
  vertical-align: middle;
}
</style>
<div class="row" align="right">
  <div class="column">
    <img src="wedding.jpg">
    <img src="rocks.jpg">
  </div>
  <div class="column">
    <img src="underwater.jpg">
    <img src="ocean.jpg">
  </div>
</div>

The above plot shows the 5 most over- and underpriced animals according to the linear regression model. I will discuss some of them, with a particular focus on what these results tell us about the linear regression model itself. The most overpriced animal 

<h2 id="overfitting">Does the Model Overfit?</h2>
<h2 id="conclusion">Conclusion</h2>
</div>
</body>

</html>
